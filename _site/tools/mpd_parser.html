<h1>MPD email parser</h1>

<p>How to use this tool:
  <ol>
    <li>Login to your fundraising page (<a target="_" href="https://app.managedmissions.com/">app.managedmissions.com/</a>) </li>
    <li>Click on the mission:<br><img src="mpd_parser_1.png" width="450" border="2"></li>
    <li>On the mission page, click the "Fundraising" tab:<br><img src="mpd_parser_2.png" width="450" border="2"></li>
    <li>On the fundraising tab, click the "Export My Contributions" option:<br><img src="mpd_parser_3.png" width="600" border="2"></li>
    <li>This will let you download a .csv file</li>
    <li>Copy the contents of that file into the text field below</li>
    <li>Click "Go"</li>
  </ol>
</p>

<textarea id="input" rows="15" cols="120">

</textarea>

<br><button onclick="getEmails()">Go</button><br>

<textarea id="output" rows="5" cols="120">
When you click "Go," the emails will appear here.
</textarea>

<script>
  function getEmails(){
    let csv = document.getElementById("input").value
    const lines = csv.split("\n").slice(1);
    l = lines.map( 
      (o) => {return ' ' + o.split(',').slice(-3,-2).toString().replace(/"/g, "")}
      )
    // line1 = lines[0].split(',').slice(-3,-2).toString().replace(/"/g, "")
    const emails = l
    document.getElementById("output").value=emails;
  }
</script>