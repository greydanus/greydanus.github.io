I"ñ1<div>
	<style>
		#linkbutton:link, #linkbutton:visited {
		  background-color: rgb(180,180,180);
		  border-radius: 4px;
		  color: white;
		  padding: 6px 0px;
		  width: 150px;
		  text-align: center;
		  text-decoration: none;
		  display: inline-block;
		  text-transform: uppercase;
		  font-size: 13px;
		  margin: 8px;
		}

		#linkbutton:hover, #linkbutton:active {
		  background-color: rgba(160,160,160);
		}

		.playbutton {
		  background-color: rgba(0, 153, 51);
		  /*background-color: rgba(255, 130, 0);*/
		  border-radius: 4px;
		  color: white;
		  padding: 3px 8px;
		  /*width: 60px;*/
		  text-align: center;
		  text-decoration: none;
		  text-transform: uppercase;
		  font-size: 12px;
		  /*display: block;*/
		  /*margin-left: auto;*/
		  margin: 8px 0px;
		  margin-right: auto;
		  min-width:80px;
		}
	</style>
</div>

<h2 id="the-physics-of-flight">The Physics of Flight</h2>

<p>Legos are this wonderful meta-toy in that they represent the potential for a near-infinite number of awesome toys depending on how you assemble them. Every brick has structure. But they are interesting only to the extent that they can combine with other bricks so as to form new structures at a higher level of abstraction. So in order to enjoy Legos, you have to figure out how they fit together and come up with a clever way of making the particular toy you have in mind. The open-ended design of Lego bricks puts all the power and responsibility for creation in your hands, and this ends up being incredibly satisfying.</p>

<p>As an adult, I find myself appreciating the same things in the physical world that I appreciated in Legos when I was younger. The beauty of physical laws is their simplicity. It‚Äôs a special kind of simplicity that, like Lego bricks, allows intricate structures to form at many levels. You see this everywhere you look in nature, across all scales of space and time. In the fractal design of a seashell or the intricate polities of a coral. In the circulation of the atmosphere or the convection of a teacup. And it‚Äôs this open-endedness that has made possible some of humanity‚Äôs most ingenious inventions.</p>

<p>Up to this point, we have focused on the human desire to fly and the circumstances under which wings were invented. Now we are going to touch on the physical laws to which flight is beholden. These laws are miraculous in their own right for, like Legos, they say little but imply a lot. As a demonstration, I am going to write down a very short equation for the flow of air. Starting from just this equation, I am going to build a simple wind tunnel and use it to design an airfoil. What you‚Äôre going to observe is a practical demonstration of the rule, ‚Äúform follows function:‚Äù out of the physics of airflow and the command ‚Äúmaximize lift while minimizing drag‚Äù the form of a wing will materialize.</p>

<p>We will begin this journey with the ‚ÄúNavier-Stokes equation‚Äù which describes how many infinitesimal parcels of fluid interact with one another:</p>

<p>The process of solving problems in fluid dynamics generally comes down to writing out this equation and then deciding which terms we can safely ignore. In our case, we‚Äôd like to simulate the flow of air through a wind tunnel so as to evaluate various airfoil designs. So one of the first assumptions we can make is that the air is incompressible. Since the pressure differences across a wind tunnel are small, this turns out to be a good assumption.</p>

<p>Another term we can ignore is viscous diffusion. Oil and molasses are examples of fluids with high viscosity. Air, on the other hand, has relatively low viscosity. Viscous interactions do form a boundary layer along the edge of an airfoil, but for the purposes of this toy experiment we will ignore that effect.</p>

<p>The final term we can ignore is the forces term, as there will be no forces on the air once it enters the tunnel. And so we are left with but a hair of the original Navier-Stokes hairball.</p>

<p>This hair is responsible for the effects that really dominate wind tunnel physics. The term on the right is called ‚Äúself-advection‚Äù and intuitively it means that ‚Äúvelocity follows itself‚Äù in a fluid flow.</p>

<p>Now that we‚Äôve simplified the physics of a wind tunnel as much as possible, let‚Äôs talk about how to add an object to occlude the flow. Talk about masking, then briefly about making it continuous. Finally, mention technical interlude about simulating all of this over discrete intervals of time and space.</p>

<p>We have succeeded in simulating a wind tunnel in just about 100 lines of code. Now it‚Äôs time to act upon it in order to create a wing. There are actually many qualities that one could look for in a good wing, but let‚Äôs begin with the most straightforward: we want a wing that gives high lift and low drag. In other words, we want it to convert horizontal air velocity into upward force. We can measure the upward force by the change in downward airflow, which is equal and opposite to the amount of lift.</p>

<p>At this point, we have both physical constraints and an objective that we hope to pursue in the context of those constraints. In the big picture, our goal is to change the mask parameters of the occlusion so as to increase the lift/drag ratio as much as possible. In other words, we‚Äôd like to follow the gradient of the occlusion mask with respect to the lift/drag ratio. Luckily for us, there is a sophisticated tool called Autograd which allows us to find that gradient analytically. From there, all we have to do is follow that gradient in increments until we don‚Äôt see additional improvements. When this process of gradient ascent is over, we can hope to see a wing.</p>

<p>So let‚Äôs review. Our goal is to simulate a wind tunnel and use it to derive a wing shape. We began by writing down the general Navier-Stokes equation and eliminating irrelevant terms - all of them but self advection. Next, we figured out how to add a continuously-deformable occlusion in the center of the tunnel. Finally, we wrote down a definition for what a good wing should do and discussed how to optimize it. Now it is time to put everything together in about 200 lines of code and run the optimization to see what we‚Äôll get‚Ä¶</p>

<p>Sure enough, we get a wing shape. It‚Äôs worth noting that modern aircraft wings are designed in exactly this manner. Of course, the simulation itself is a bit more advanced. It‚Äôs 3D instead of 2D, uses a mesh parameterization instead of a grid, and adds laminar flow. But in spite of these improvements, the overall principle is much the same. In both cases, we write down some words and symbols, turn them into code, and use the code to shape our wing. The fact that we can do all of this without ever building a physical wing makes it feel a bit like magic. But the proof is in the pudding, for when we do put these wings on airplanes and trust them with our lives, they carry us safely to our destinations.</p>

<p>But just as with the old wind tunnels of the 1900‚Äôs, these simulations have to go through lots of debugging before we can trust them. In fact, over the course of building this demo I discovered all sorts of ways in which it could malfunction. Some of the most amusing bloopers happened while I was trying to get the optimization code dialed in.</p>

<p>Several of these bloopers are just plain dreadful. But others look like reasonable, if unexpected, solutions. I think the ‚Äútwo wing‚Äù solution is particularly fun. It was entirely unexpected and yet there‚Äôs a good precedent for it in biplanes. One of the strengths of this particular demo is its simplicity. This extreme simplicity is what made the wing objective open-ended, thus permitting all sorts of interesting accidents to occur. If we had limited the wing shape to a closed-loop topology, we never would have recovered the two-wing design.</p>

<p>In fact, the problem of designing a good wing is so open-ended that many good solutions exist. Perhaps it makes more sense to look for an entire manifold or subspace of good solutions. Sometimes we‚Äôll care more about a wing that is optimal at high speeds and other times we‚Äôll want one that‚Äôs optimal at low speeds. Maybe we‚Äôll want one that is stable across many speeds. What‚Äôs more, we may want a particularly thick wing so as to accommodate, for example, a large fuselage. Or, we may want to keep the mass of the wing low so as to reduce weight. Taking these sorts of design constraints into account, we can solve for a whole manifold of valid solutions.</p>

<p>Most scientists probably won‚Äôt be shocked by the revelation that design problems are open-ended. However, there are many ways in which people ignore the open-ended nature of the real world. This begins when we are still young and take our first standardized test. These tests instill a ‚Äúone solution is best‚Äù mode of thought in students and once they‚Äôve outgrown them it‚Äôs easy to latch on to other metrics to optimize. Some tempting ones include salary, social media followers, admission rates, and citation metrics. But nature is different.</p>

<p>Nature takes a consummate joy in variation. Consider flight in birds. Some species prioritize high body mass and quick, agile flight patterns. Others, like the albatross, are soaring birds built for extreme efficiency. Still others, like the _ are good ‚Äúall-around‚Äù fliers who adapt well to a variety of environments.</p>

<p>Although we lack some of Nature‚Äôs refinement and nuance, human flying machines follow some of the same patterns. We have ultra-efficient planes built for soaring, short-winged bush planes for maneuverability, and massive commercial airliners for stability and volume.</p>

<p>Perhaps less intuitively, a single bird is often capable of a wide range of wing shapes. The falcon, for example, uses different wing shapes for soaring, diving, turning, and landing. The wing is not, in fact, a static thing, but rather a deformable, dynamic object which is constantly adapting to its surroundings. Modern airplanes are starting to explore this possibility too, with airfoils composed of adjustable overlapping flaps that can be rearranged for takeoff, cruising, and landing.</p>

<p>The general process by which evolution divides one successful pattern into an array of related but specialized versions is called speciation. It‚Äôs a complicated process because the success of one species tends to drive the formation or extinction of several related species. You see a similar pattern in the history of plane designs, especially fighter crafts. The German _ airplanes of World War II, for example, inspired the United States to make fighters that could ‚Äú‚Äù, and thus avoid ‚Äú‚Äù.</p>

<p>In optimization and machine learning, the idea that many problems are open-ended and we should look for a set of equally valid solutions is called ‚Äúquality-diversity.‚Äù It‚Äôs still a fledgling area of research, but notable papers on the topic include ‚Äú‚Äù and ‚Äú‚Äù. Jeff Clune gives a strong overview in his ICML 2019 tutorial. On a related thread, a series of papers on reinforcement learning illustrate the value of self play or league play. These papers tend to use the perspective of game theory to argue in favor of a diverse set of policies so as to construct a stable Nash equilibrium of policies. The core observation here is that the better and more diverse the league of agents gets, the better and more robust any one policy tends to become.</p>

<p>It‚Äôs interesting that quality-diversity is such an important concept across disparate fields such as bird flight, fighter aircraft, and AI algorithms. The common thread here is that this diversity becomes increasingly important as the objective gets more open-ended.</p>

<p>With this in mind, we should ask ourselves just how open-ended our optimization function was for the wing example. We already know that a variety of wing shapes can attain high performance on the task. We should also note that the final wing shape is rather sensitive to the initial shape and density of the occlusion. More generally, though, the optimization function itself is never the full story. When we write down the objective function, behind it there is a desire to form a wing shape, and behind that, a desire for flight, and behind that - perhaps - a desire for freedom, and behind that, what? The paradox of an objective function is that it always seems to have some grander intent behind it. One of our crises and challenges as human beings is that we can discover this paradox, and must somehow resolve it.</p>

<h2 id="footnotes">Footnotes</h2>

:ET